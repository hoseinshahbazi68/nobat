<div class="home-container">
  <!-- Chat Button -->
  <button class="chat-button" (click)="openChat()" aria-label="ุจุงุฒ ฺฉุฑุฏู ฺุช ุขููุงู">
    <span class="chat-icon">๐ฌ</span>
    <span class="chat-badge" *ngIf="false">1</span>
  </button>

  <!-- Header Section -->
  <header class="home-header">
    <div class="header-background">
      <div class="bg-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
      </div>
    </div>
    <nav class="home-nav">
      <div class="nav-brand">
        <span class="brand-icon">๐ฅ</span>
        <span class="brand-text">ููุจุชโุฏู ุขููุงู</span>
      </div>
      <div class="nav-links">
        <a routerLink="/home" class="nav-link active">
          <span class="nav-icon">๐</span>
          ุฌุณุชุฌู ูพุฒุดฺฉุงู
        </a>
        <a routerLink="/login" class="nav-link">
          <span class="nav-icon">๐</span>
          ูุฑูุฏ
        </a>
        <a routerLink="/panel" class="nav-link">
          <span class="nav-icon">โ๏ธ</span>
          ูพูู ูุฏุฑุช
        </a>
      </div>
    </nav>
    <div class="header-content">
      <div class="hero-content">
        <h1 class="home-title">
          <span class="title-line">ูพุฏุง ฺฉุฑุฏู ูพุฒุดฺฉ</span>
          <span class="title-line highlight">ุขุณุงูโุชุฑ ุงุฒ ููุดู</span>
        </h1>
        <p class="home-subtitle">ุจุง ุฌุณุชุฌู ูพุดุฑูุชู ู ููุชุฑูุง ููุดููุฏุ ุจูุชุฑู ูพุฒุดฺฉ ุฑุง ุฏุฑ ฺฉูุชุงูโุชุฑู ุฒูุงู ูพุฏุง ฺฉูุฏ</p>
        <div class="hero-stats">
          <div class="stat-item">
            <span class="stat-number">+{{ filteredDoctors.length }}</span>
            <span class="stat-label">ูพุฒุดฺฉ ูุนุงู</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">ฒด/ท</span>
            <span class="stat-label">ูพุดุชุจุงู ุขููุงู</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">ฑฐฐูช</span>
            <span class="stat-label">ุฑุฒุฑู ุขููุงู</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="home-main">
    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" *ngIf="isMobile && sidebarOpen" (click)="toggleSidebar()"></div>

    <div class="home-layout">
      <!-- Sidebar Filters -->
      <aside class="filters-sidebar" [class.mobile-open]="sidebarOpen">
        <div class="sidebar-header">
          <h3>ููุชุฑูุง</h3>
          <button class="close-sidebar" (click)="toggleSidebar()" *ngIf="isMobile">
            <span>โ</span>
          </button>
        </div>

        <!-- Clear All Filters -->
        <div class="filter-section" *ngIf="hasActiveFilters()">
          <button class="btn-clear-all" (click)="clearAllFilters()">
            <span class="icon">๐๏ธ</span>
            ุญุฐู ููู ููุชุฑูุง
          </button>
        </div>

        <!-- Search Filter -->
        <div class="filter-section">
          <label class="filter-label">ุฌุณุชุฌู</label>
          <div class="search-filter">
            <input type="text" [(ngModel)]="searchQuery" (keyup)="applyFilters()"
              placeholder="ูุงู ูพุฒุดฺฉุ ฺฉููฺฉุ ุชุฎุตุต..." [disabled]="isLoading">
            <span class="search-icon">๐</span>
          </div>
        </div>

        <!-- Specialty Filter -->
        <div class="filter-section">
          <label class="filter-label">ุชุฎุตุต</label>
          <div class="dropdown-container">
            <button class="dropdown-trigger" (click)="toggleSpecialtyDropdown()">
              <span class="dropdown-text">
                <span class="dropdown-icon" *ngIf="selectedSpecialty !== null">{{
                  getSpecialtyIcon(getSelectedSpecialtyName()) }}</span>
                {{ getSelectedSpecialtyName() }}
              </span>
              <span class="dropdown-arrow" [class.open]="specialtyDropdownOpen">โผ</span>
            </button>
            <div class="dropdown-menu" *ngIf="specialtyDropdownOpen">
              <div class="dropdown-search">
                <input type="text" [(ngModel)]="specialtySearchQuery" (click)="$event.stopPropagation()"
                  placeholder="ุฌุณุชุฌู ุชุฎุตุต..." class="dropdown-search-input">
                <span class="search-icon">๐</span>
              </div>
              <div class="dropdown-options">
                <button class="dropdown-option" [class.selected]="selectedSpecialty === null"
                  (click)="selectSpecialty(null)">
                  ููู ุชุฎุตุตโูุง
                </button>
                <button *ngFor="let specialty of getFilteredSpecialties()" class="dropdown-option"
                  [class.selected]="selectedSpecialty === specialty.id" (click)="selectSpecialty(specialty.id!)">
                  <span class="option-icon">{{ getSpecialtyIcon(specialty.name) }}</span>
                  {{ specialty.name }}
                </button>
                <div class="dropdown-empty" *ngIf="getFilteredSpecialties().length === 0">
                  ูุชุฌูโุง ุงูุช ูุดุฏ
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Medical Condition Filter -->
        <div class="filter-section">
          <label class="filter-label">ุนูุงุฆู ู ูุดฺฉูุงุช</label>
          <div class="dropdown-container">
            <button class="dropdown-trigger" (click)="toggleMedicalConditionDropdown()">
              <span class="dropdown-text">
                {{ selectedMedicalCondition || 'ููู ุนูุงุฆู' }}
              </span>
              <span class="dropdown-arrow" [class.open]="medicalConditionDropdownOpen">โผ</span>
            </button>
            <div class="dropdown-menu" *ngIf="medicalConditionDropdownOpen">
              <div class="dropdown-search">
                <input type="text" [(ngModel)]="medicalConditionSearchQuery" (click)="$event.stopPropagation()"
                  placeholder="ุฌุณุชุฌู ุนูุงุฆู..." class="dropdown-search-input">
                <span class="search-icon">๐</span>
              </div>
              <div class="dropdown-options">
                <button class="dropdown-option" [class.selected]="selectedMedicalCondition === ''"
                  (click)="selectMedicalCondition('')">
                  ููู ุนูุงุฆู
                </button>
                <button *ngFor="let condition of getFilteredMedicalConditions()" class="dropdown-option"
                  [class.selected]="selectedMedicalCondition === condition.name" (click)="selectMedicalCondition(condition.name!)">
                  {{ condition.name }}
                </button>
                <div class="dropdown-empty" *ngIf="getFilteredMedicalConditions().length === 0">
                  ูุชุฌูโุง ุงูุช ูุดุฏ
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Gender Filter -->
        <div class="filter-section">
          <label class="filter-label">ุฌูุณุช ูพุฒุดฺฉ</label>
          <div class="filter-options gender-options">
            <button class="filter-option" [class.active]="selectedGender === null" (click)="selectGender(null)">
              <span class="option-icon">๐ฅ</span>
              ููู
            </button>
            <button class="filter-option" [class.active]="selectedGender === 'male'" (click)="selectGender('male')">
              <span class="option-icon">๐จ</span>
              ุขูุง
            </button>
            <button class="filter-option" [class.active]="selectedGender === 'female'" (click)="selectGender('female')">
              <span class="option-icon">๐ฉ</span>
              ุฎุงูู
            </button>
          </div>
        </div>

        <!-- City Filter -->
        <div class="filter-section" *ngIf="availableCities.length > 0">
          <label class="filter-label">ุดูุฑ</label>
          <div class="dropdown-container">
            <button class="dropdown-trigger" (click)="toggleCityDropdown()">
              <span class="dropdown-text">{{ getSelectedCityName() }}</span>
              <span class="dropdown-arrow" [class.open]="cityDropdownOpen">โผ</span>
            </button>
            <div class="dropdown-menu" *ngIf="cityDropdownOpen">
              <div class="dropdown-search">
                <input type="text" [(ngModel)]="citySearchQuery" (click)="$event.stopPropagation()"
                  placeholder="ุฌุณุชุฌู ุดูุฑ..." class="dropdown-search-input">
                <span class="search-icon">๐</span>
              </div>
              <div class="dropdown-options">
                <button class="dropdown-option" [class.selected]="selectedCity === null" (click)="selectCity(null)">
                  ููู ุดูุฑูุง
                </button>
                <button *ngFor="let city of getFilteredCities()" class="dropdown-option"
                  [class.selected]="selectedCity === city" (click)="selectCity(city)">
                  {{ city }}
                </button>
                <div class="dropdown-empty" *ngIf="getFilteredCities().length === 0">
                  ูุชุฌูโุง ุงูุช ูุดุฏ
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Clinic Filter -->
        <div class="filter-section" *ngIf="availableClinics.length > 0">
          <label class="filter-label">ฺฉููฺฉ</label>
          <div class="dropdown-container">
            <button class="dropdown-trigger" (click)="toggleClinicDropdown()">
              <span class="dropdown-text">{{ getSelectedClinicName() }}</span>
              <span class="dropdown-arrow" [class.open]="clinicDropdownOpen">โผ</span>
            </button>
            <div class="dropdown-menu" *ngIf="clinicDropdownOpen">
              <div class="dropdown-search">
                <input type="text" [(ngModel)]="clinicSearchQuery" (click)="$event.stopPropagation()"
                  placeholder="ุฌุณุชุฌู ฺฉููฺฉ..." class="dropdown-search-input">
                <span class="search-icon">๐</span>
              </div>
              <div class="dropdown-options">
                <button class="dropdown-option" [class.selected]="selectedClinicId === null"
                  (click)="selectClinic(null)">
                  ููู ฺฉููฺฉโูุง
                </button>
                <button *ngFor="let clinic of getFilteredClinics()" class="dropdown-option"
                  [class.selected]="selectedClinicId === clinic.id" (click)="selectClinic(clinic.id ?? null)">
                  {{ clinic.name }}
                </button>
                <div class="dropdown-empty" *ngIf="getFilteredClinics().length === 0">
                  ูุชุฌูโุง ุงูุช ูุดุฏ
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Service Filter -->
        <div class="filter-section" *ngIf="availableServices.length > 0">
          <label class="filter-label">ุฎุฏูุช</label>
          <div class="dropdown-container">
            <button class="dropdown-trigger" (click)="toggleServiceDropdown()">
              <span class="dropdown-text">{{ getSelectedServiceName() }}</span>
              <span class="dropdown-arrow" [class.open]="serviceDropdownOpen">โผ</span>
            </button>
            <div class="dropdown-menu" *ngIf="serviceDropdownOpen">
              <div class="dropdown-search">
                <input type="text" [(ngModel)]="serviceSearchQuery" (click)="$event.stopPropagation()"
                  placeholder="ุฌุณุชุฌู ุฎุฏูุช..." class="dropdown-search-input">
                <span class="search-icon">๐</span>
              </div>
              <div class="dropdown-options">
                <button class="dropdown-option" [class.selected]="selectedServiceId === null"
                  (click)="selectService(null)">
                  ููู ุฎุฏูุงุช
                </button>
                <button *ngFor="let service of getFilteredServices()" class="dropdown-option"
                  [class.selected]="selectedServiceId === service.id" (click)="selectService(service.id ?? null)">
                  {{ service.name }}
                </button>
                <div class="dropdown-empty" *ngIf="getFilteredServices().length === 0">
                  ูุชุฌูโุง ุงูุช ูุดุฏ
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Insurance Filter -->
        <div class="filter-section" *ngIf="availableInsurances.length > 0">
          <label class="filter-label">ุจูู</label>
          <div class="dropdown-container">
            <button class="dropdown-trigger" (click)="toggleInsuranceDropdown()">
              <span class="dropdown-text">{{ getSelectedInsuranceName() }}</span>
              <span class="dropdown-arrow" [class.open]="insuranceDropdownOpen">โผ</span>
            </button>
            <div class="dropdown-menu" *ngIf="insuranceDropdownOpen">
              <div class="dropdown-search">
                <input type="text" [(ngModel)]="insuranceSearchQuery" (click)="$event.stopPropagation()"
                  placeholder="ุฌุณุชุฌู ุจูู..." class="dropdown-search-input">
                <span class="search-icon">๐</span>
              </div>
              <div class="dropdown-options">
                <button class="dropdown-option" [class.selected]="selectedInsuranceId === null"
                  (click)="selectInsurance(null)">
                  ููู ุจููโูุง
                </button>
                <button *ngFor="let insurance of getFilteredInsurances()" class="dropdown-option"
                  [class.selected]="selectedInsuranceId === insurance.id" (click)="selectInsurance(insurance.id ?? null)">
                  {{ insurance.name }}
                </button>
                <div class="dropdown-empty" *ngIf="getFilteredInsurances().length === 0">
                  ูุชุฌูโุง ุงูุช ูุดุฏ
                </div>
              </div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Content Area -->
      <div class="main-content-area">
        <!-- Top Bar -->
        <div class="top-bar">
          <div class="results-info">
            <h2 class="section-title">
              ูุณุช ูพุฒุดฺฉุงู
              <span class="doctors-count" *ngIf="!isLoading">
                ({{ filteredDoctors.length }})
              </span>
            </h2>
          </div>
          <button class="btn-toggle-filters" (click)="toggleSidebar()" *ngIf="isMobile">
            <span class="icon">โ๏ธ</span>
            ููุชุฑูุง
          </button>
        </div>

        <!-- Doctors List -->
        <div class="doctors-container" [class.loading]="isLoading">
          <app-loading *ngIf="isLoading" [overlay]="false" message="ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ูพุฒุดฺฉุงู..."></app-loading>

          <div class="doctors-grid" *ngIf="!isLoading && filteredDoctors.length > 0">
            <div class="doctor-card modern-card" *ngFor="let doctor of filteredDoctors; let i = index">
              <div class="card-glow"></div>
              <div class="doctor-card-header">
                <div class="avatar-wrapper">
                  <div class="doctor-avatar" [style.background]="getAvatarGradient(i)">
                    <span class="avatar-icon">{{ getAvatarIcon(doctor) }}</span>
                  </div>
                  <div class="status-indicator active"></div>
                </div>
                <div class="doctor-info">
                  <h3 class="doctor-name">{{ getDoctorName(doctor) }}</h3>
                  <div class="doctor-specialty">
                    <span class="specialty-icon">{{ getSpecialtyIcon(getSpecialtiesDisplay(doctor)) }}</span>
                    <span class="specialty-text">{{ getSpecialtiesDisplay(doctor) }}</span>
                  </div>
                </div>
              </div>

              <div class="doctor-card-body">
                <div class="info-section">
                  <div class="info-row" *ngIf="getDoctorPhone(doctor)">
                    <div class="info-label">
                      <span class="info-icon">๐</span>
                      ุชููู
                    </div>
                    <a [href]="'tel:' + getDoctorPhone(doctor)" class="info-value link">{{ getDoctorPhone(doctor) }}</a>
                  </div>

                  <div class="info-row" *ngIf="getDoctorEmail(doctor)">
                    <div class="info-label">
                      <span class="info-icon">๐ง</span>
                      ุงูู
                    </div>
                    <a [href]="'mailto:' + getDoctorEmail(doctor)" class="info-value link">{{ getDoctorEmail(doctor)
                      }}</a>
                  </div>

                  <div class="info-row">
                    <div class="info-label">
                      <span class="info-icon">๐</span>
                      ฺฉุฏ ูุธุงู ูพุฒุดฺฉ
                    </div>
                    <span class="info-value">{{ doctor.medicalCode }}</span>
                  </div>

                  <div class="info-row" *ngIf="getDoctorAddresses(doctor).length > 0">
                    <div class="info-label">
                      <span class="info-icon">๐</span>
                      ุขุฏุฑุณ
                    </div>
                    <div class="info-value address-value">
                      <span *ngFor="let address of getDoctorAddresses(doctor); let last = last" class="address-item">
                        {{ address }}<span *ngIf="!last"> โข </span>
                      </span>
                    </div>
                  </div>

                  <div class="info-row" *ngIf="doctor.clinics && doctor.clinics.length > 0">
                    <div class="info-label">
                      <span class="info-icon">๐ฅ</span>
                      ฺฉููฺฉโูุง
                    </div>
                    <div class="info-value clinics-value">
                      <span *ngFor="let clinic of doctor.clinics; let last = last" class="clinic-tag">
                        {{ clinic.name }}<span *ngIf="!last">ุ </span>
                      </span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="doctor-card-footer">
                <button class="btn-appointment modern-btn" (click)="bookAppointment(doctor)">
                  <span class="btn-icon">๐</span>
                  <span class="btn-text">ุฑุฒุฑู ููุจุช</span>
                  <span class="btn-arrow">โ</span>
                </button>
              </div>
            </div>
          </div>

          <div class="empty-state" *ngIf="!isLoading && filteredDoctors.length === 0">
            <div class="empty-icon">๐</div>
            <h3>ูพุฒุดฺฉ ุงูุช ูุดุฏ</h3>
            <p>ูุชุฃุณูุงูู ุจุง ููุชุฑูุง ุงูุชุฎุงุจ ุดูุง ูพุฒุดฺฉ ุงูุช ูุดุฏ. ูุทูุงู ููุชุฑูุง ุฑุง ุชุบุฑ ุฏูุฏ.</p>
            <button class="btn-clear-filters" (click)="clearAllFilters()" *ngIf="hasActiveFilters()">
              ูพุงฺฉ ฺฉุฑุฏู ููุชุฑูุง
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
